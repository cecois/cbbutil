"use strict";var CONFIG={verbose:!1,dev:!1,mode:"33",proxy:null,basemap:"pencil",index_root:"http://milleria.org:9200/cbb/_search?",default_query:"watch"};window.map=new L.Map("map",{zoomControl:!1,center:[51.505,-.09],zoom:7,attributionControl:!1}).on("moveend",function(e){"undefined"!=typeof appRoute&&appRoute.up()}),Handlebars.registerHelper("equal",function(e,a,s){if(arguments.length<3)throw new Error("Handlebars Helper equal needs 2 parameters");return e!=a?s.inverse(this):s.fn(this)}),Handlebars.registerHelper("debug",function(e){return console.log(e),new Handlebars.SafeString(this.instance)}),Handlebars.registerHelper("episodizer",function(e,a){if(e.toString().indexOf("/")>=0){var s=e.split("/"),n=s[s.length-1];return new Handlebars.SafeString(n)}return new Handlebars.SafeString(e.toString())});var states=[{name:"main",posish:"open",visible:!0},{name:"episodes",posish:"open",visible:!0},{name:"banner-bang",posish:"open",visible:!0}],baselayersdummified={layers:[{name:"dummy",active:!0,source:"localhost",nom:"A Real Dummy",thumb:"/images/bm-dummy-thumb.png",mapis:"dark",definition:{maxZoom:18,url:"/images/bm-dummy-thumb.png",noWrap:!0}},{name:"dummy",active:!1,source:"localhost",nom:"A Real Dummy",thumb:"/images/bm-dummy-thumb.png",mapis:"dark",definition:{maxZoom:18,url:"/images/bm-dummy-thumb.png",noWrap:!0}}]},baselayersdesk={layers:[{name:"super_mario",active:!1,source:"mapbox",nom:"Duncan Graham's Super Mario",thumb:"/images/bm-mapbox-mario.png",mapis:"light",definition:{subdomains:["a","b","c"],maxZoom:18,url:"https://{s}.tiles.mapbox.com/v4/duncangraham.552f58b0/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1IjoiZHVuY2FuZ3JhaGFtIiwiYSI6IlJJcWdFczQifQ.9HUpTV1es8IjaGAf_s64VQ",noWrap:!0}},{name:"lichtenstein",active:!1,source:"mapbox",nom:"Katie Kowalsky's Pop Art (Inspored by Roy lichtenstein)",thumb:"/images/bm-mapbox-popart.png",mapis:"dark",definition:{subdomains:["a","b","c"],maxZoom:18,url:"https://{s}.tiles.mapbox.com/v4/katiekowalsky.236692c1/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1Ijoia2F0aWVrb3dhbHNreSIsImEiOiJHR2hfdlBNIn0.GUMLsSnT-SYx4ew7b77kqw",noWrap:!0}},{name:"pencil",active:!0,source:"mapbox",nom:"Aj Ashton's Pencil Map",thumb:"/images/bm-mapbox-pencil.png",mapis:"dark",definition:{subdomains:["a","b","c"],maxZoom:18,url:"https://{s}.tiles.mapbox.com/v4/aj.03e9e12d/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1IjoiYWoiLCJhIjoiY2lrZW1pczJzMDA1d3VybTJha216azVtdSJ9.vJBkGAq6CvN9vt0IwakQ-A",noWrap:!0}},{name:"opencycle_landscape",active:!1,source:"opencycle",nom:"OpenCycle Landscape",thumb:"/images/bm-opencycleland.png",mapis:"dark",definition:{maxZoom:18,subdomains:["a","b","c"],noWrap:!0,url:"http://{s}.tile3.opencyclemap.org/landscape/{z}/{x}/{y}.png"}}]},baselayersmobile={layers:[{name:"pencil",active:!0,source:"mapbox",nom:"Aj Ashton's Pencil Map",thumb:"/images/bm-mapbox-pencil.png",mapis:"dark",definition:{subdomains:["a","b","c"],maxZoom:18,url:"https://{s}.tiles.mapbox.com/v4/aj.03e9e12d/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1IjoiYWoiLCJhIjoiY2lrZW1pczJzMDA1d3VybTJha216azVtdSJ9.vJBkGAq6CvN9vt0IwakQ-A",noWrap:!0}},{name:"dummy",active:!1,source:"localhost",nom:"A Real Dummy",thumb:"/images/bm-dummy-thumb.png",mapis:"dark",definition:{maxZoom:18,url:"/images/bm-dummy-thumb.png",noWrap:!0}}]},appSlugs=new Slugs([{name:"Home",slug:"home",active:!1},{name:"Huh?",slug:"huh",active:"is-active"},{name:"Search",slug:"search",active:!1},{name:"Browse",slug:"browse",active:!1},{name:"Update",slug:"update",active:!1},{name:"Help",slug:"help",active:!1}]),appQueryFacets=new QueryFacets,appQuery=new Query({raw:CONFIG.default_query}),appQueryView=new QueryView({model:appQuery}),appState=new State,appStateViewDownMenu=new StateViewDownMenu({model:appState}),appUpdates=new Updates,appUpdatesView=new UpdatesView({collection:appUpdates}),appFacetsBits=new Facets,appFacetsEpisodes=new Facets,appFacetsTags=new Facets,appFacetsGuests=new Facets,BitGroup=(new L.featureGroup).addTo(map),appLocations=new Locations,appBits=new Bits,appBitsView=new BitsView({collection:appBits}),appBrowseBits=new Browse,appBrowseTags=new Browse,appBrowseEpisodes=new Browse,appBrowseGuests=new Browse,appBrowseMaster=new Browse,appBrowseBitsView=new BrowseView({el:"#browse-bits",collection:appBrowseBits,type:"bit"}),appBrowseTagsView=new BrowseView({el:"#browse-tags",collection:appBrowseTags,type:"tag"}),appBrowseEpisodesView=new BrowseView({el:"#browse-episodes",collection:appBrowseEpisodes,type:"episode"}),appBrowseGuestsView=new BrowseView({el:"#browse-guests",collection:appBrowseGuests,type:"episode"}),appLocationsView=new LocationsView({collection:appLocations}),appSlugsViewPanes=new SlugsViewPanes({collection:appSlugs}),appSlugsViewPanesMenu=new SlugsViewPanesMenu({collection:appSlugs}),appFacetsBitsView=new FacetsView({el:"#search-facets-bits",collection:appFacetsBits,type:"bit"}),appFacetsEpisodesView=new FacetsView({el:"#search-facets-episodes",collection:appFacetsEpisodes,type:"episode"}),appFacetsTagsView=new FacetsView({el:"#search-facets-tags",collection:appFacetsTags,type:"tags"}),appFacetsGuestsView=new FacetsView({el:"#search-facets-guests",collection:appFacetsGuests,type:"guests"}),UTIL=new Util,appActivity=new Activity({message:"loading..."}),appActivityView=new ActivityView({model:appActivity}),baselayers="T"==CONFIG.mode?baselayersdummified:baselayersdesk,appBaseLayers=new BaseLayersCollection(baselayers.layers),appBaseLayersMenuView=new BaseLayersMenuView({collection:appBaseLayers}),appBaseMapView=new BaseLayersView({collection:appBaseLayers}),fields={fields:[{order:1,name:"anno",nom:"short annotation of the location -- e.g. 'one of Huell Howser's homes'",scope_and_use:"use it freely, e.g. <span class='copy-trigger' data-string='anno:huell'><span class='loc-string'>anno:huell</span><i class='glyphicon glyphicon-map-marker cbb-trigger-inline'></i></span> or <span class='copy-trigger' data-string='anno:cake+boss'><span class='loc-string'>anno:cake+boss</span><i class='glyphicon glyphicon-map-marker cbb-trigger-inline'></i></span>"},{order:5,name:"cartodb_id",nom:"unique id per site",scope_and_use:"use it to link to a specific instance, e.g. <span class='copy-trigger' data-string='cartodb_id:108'><span class='loc-string'>cartodb_id:108</span><i class='glyphicon glyphicon-map-marker cbb-trigger-inline'></i></span> - ~site of Bob Ducca's booth at the Silver Lake Farmers Market"},{order:3,name:"created_at",nom:"date the location was logged (has nothing to do with its appearance on the show)",scope_and_use:"I'm not sure anybody could possibly care. But I guess you could do Solr range queries with it."},{order:0,name:"name",nom:"name of the site (e.g. 'Six Flags Valencia' or 'Boston, MA'",scope_and_use:"this and anno are the primary fields and this is the one with the placename"},{order:2,name:"text",nom:"catch-all field",scope_and_use:"searching this field queries both anno and name fields (and eventually any other text we wanna throw in). If you don't type a specific field (e.g. you just type 'Dimello') this is the field that gets called."},{order:4,name:"updated_at",nom:"date of the last update to this record",scope_and_use:"Eh. You can <a href='#recent'>query for updates</a> with it I suppose."}]};$(document).ready(function(){}),$(document).keydown(function(e){17==e.keyCode&&appStateViewDownMenu.setm()});